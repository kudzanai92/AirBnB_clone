U
    €ÂØd S  ã                    @   sr   d Z d d l Z d d l Z d d l m Z   d d l m Z   d d lm Z   d d l	m
Z
  d d l
Z
G dd „ d e j 
ƒ Z
e 
d	k rne   ¡   d S )
z%Unit test for the file storage class
é    N) Ú StringIO) Ú patch) Ú
HBNBCommand) Ú
FileStoragec                    @   sl   e Z d Z d Z d Z d d „ Z d d „ Z dd „ Zd	d
„ Z d
d 
„ Z	d
d 
„ Z
d d „ Z
d d „ Z 
d d „ Z
d d „ Z 
d d „ Z d d „ Z d d „ Z d d „ Z d¬d „ Z d!d"„ Z d#d$„ Z d%d&„ Z d'd(„ Z d)d*„ Z d+d,„ Z d-d.„ Z d/d0„ Z d1d2„ Z d3d4„ Z d5d6„ Z d7d8„ Z¬d9d:„ Z d;d<„ Z!d=d>„ Z"d?d@„ Z#dAdB„ Z$dCdD„ Z%dEdF„ Z&dGdH„ Z'dIdJ„ Z(dKdL„ Z)dMdN„ Z*dOdP„ Z+dQdR„ Z,dSdT„ Z-dUdV„ Z.dWdX„ Z/d S )YÚ TestConsoleClasszVTestConsoleClass resume
    Args:
        unittest (): Propertys for unit testing
    Nc                	   C   s&   t d d ƒ    d t _ i t _ W 5 Q R X d S ) z¬ condition to test file saving ú	test.jsonÚ wN) Ú openr    Ú _FileStorage__file_pathZ _FileStorage__objects© Ú self© r
   ú(/root/AirBnB_clone/tests/test_console.pyÚ setUp    s       
   z TestConsoleClass.setUpc                    C   s.   d t _ z 
t   d ¡   W n   t k
r(      Y n X d S ) z  destroys created file z	file.jsonr   N) r    r
   Ú osÚ removeÚ FileNotFoundErrorr
   r
   r
   r 
   Ú tearDown    s
          
  
 z TestConsoleClass.tearDownc                    C   s    |   t t j ƒ d k ¡   d S ) z  check for module documentation r    N© Ú
assertTrueÚ lenr    Ú__doc__r
   r
   r
   r 
   Ú test_module_doc$   s      z TestConsoleClass.test_module_docc                    C   s    |   t t j ƒ d k ¡   d S ) z  check for documentation r    Nr    r
   r
   r
   r 
   Ú 
test_class_doc(   s      z-TestConsoleClass.test_class_docc                    C   s&   t t ƒ D ] } |   t | j ƒ d k ¡   q d S ) z  check for method documentation r    N) Ú dirr    r    r    r    ) r 
   Ú funcr
   r
   r 
   Ú test_method_docs,   s       
 z!TestConsoleClass.test_method_docsc                    C   s6   t j d d  } d } d } |   | | g ¡ } |   | j d d ¡   dS ) z. test base and test_base for pep8 conformance T) Ú quietú
console.pyz tests/test_console.pyr    z&Found code style errors (and warning).N) Ú pep8Z
StyleGuideZ
check_filesÚ
assertEqualZ 
total_errors) r 
   Ú styleZ file1Z file2Ú resultr
   r
   r 
   Ú	test_pep81   s 
      
      
 
  ÿz TestConsoleClass.test_pep8c                    C   sL   t   d t j ¡ } |   | ¡   t   d t j ¡ } |   | ¡   t   d t j ¡ } |   | ¡   d S ) z* Check if file have permissions to executer    N) r    Ú accessÚ R_OKr    Ú W_OKÚ X_OK) r 
   Z 
is_read_trueZ
is_write_trueZ 
is_exec_truer
   r
   r 
   Ú test_executable_file:   s 
      
 
  
 
  
 z%TestConsoleClass.test_executable_filec                	   C   s0   t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X d	S )
z. Verifies that each command has a help output ú
sys.stdout© Ú newz
help creater    z help allz	help showz 
help destroyz
help updateN©r    r    r    Ú onecmdr    r    Ú getvalue© r 
   Z help_valr
   r
   r 
   Ú test_check_helpF   s         
      
      
      
      
 z TestConsoleClass.test_check_helpc                	   C   s@   t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X d S ) ú  Test the create function r)   r*   ú create BaseModelr    Nr,   r/   r
   r
   r 
   Ú test_create_goodX   s         
 z!TestConsoleClass.test_create_goodc                	   C   s:   t d t ƒ d  "} t ƒ   d ¡   |   |   ¡ d ¡   W 5 Q R X d S ) r1   r)   r*   Z createú ** class name missing **
N© r    r    r    r-   r    r.   r/   r
   r
   r 
   Ú test_create_empty^   s         
 z"TestConsoleClass.test_create_emptyc                	   C   s:   t d t ƒ d  "} t ƒ   d ¡   |   |   ¡ d ¡   W 5 Q R X d S ) r1   r)   r*   z create Holbertonú ** class doesn't exist **
Nr5   © r 
   Ú valr
   r
   r 
   Ú test_create_unknownd   s         
 z$TestConsoleClass.test_create_unknownc                	   C   s€   t d t ƒ d  ,} t ƒ   d ¡   |   ¡ } |   t | ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X dS ) z" test show with normal parameters r)   r*   r2   r    ú show BaseModel ú ** no instance found **
N©r    r    r    r-   r.   r    r    © r 
   r9   Ú 
basemodel_idr
   r
   r 
   Ú	test_showj   s 
        
         z TestConsoleClass.test_showc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z& Test with class that does not exists r)   r*   z 
show helloo r7   N© r    r    r    r-   r    r.   r8   r
   r
   r 
   Ú test_show_notfoundt   s         
 z#TestConsoleClass.test_show_notfoundc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z  Test with class missing r)   r*   Z showr4   NrA   r8   r
   r
   r 
   Ú test_show_emptyz   s         
 z TestConsoleClass.test_show_emptyc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z  Test with id missing r)   r*   z 
show BaseModelú ** instance id missing **
NrA   r8   r
   r
   r 
   Ú 
test_show_id€   s         
 z TestConsoleClass.test_show_idc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z  Checks if class is missing r)   r*   Zdestroyr4   NrA   r8   r
   r
   r 
   Ú test_destroy_empty†   s         
 z#TestConsoleClass.test_destroy_emptyc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z& Checks if class name does not exists r)   r*   z destroy fakeclassr7   NrA   r8   r
   r
   r 
   Ú test_destroy_wrongŒ   s         
 z#TestConsoleClass.test_destroy_wrongc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z  Check if the id is missing r)   r*   z destroy BaseModelrD   NrA   r8   r
   r
   r 
   Ú test_destroy_id’   s         
 z TestConsoleClass.test_destroy_idc                	   C   sb   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S )z) Checks is the id belongs to an instance r)   r*   r2   z destroy BaseModel 121212r<   NrA   r8   r
   r
   r 
   Ú test_destroy_notfound˜   s
            
 z&TestConsoleClass.test_destroy_notfoundc                	   C   s€   t d t ƒ d  ,} t ƒ   d ¡   |   ¡ } |   t | ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X dS ) z; Checks is destroy methods deletes succesfully an instance r)   r*   r2   r    z destroy BaseModel r<   Nr=   r>   r
   r
   r 
   Ú destroy_working    s 
        
         z TestConsoleClass.destroy_workingc                	   C   sb   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S )z  Checks if class name exists r)   r*   r2   z
all FakeClassr7   NrA   r8   r
   r
   r 
   Ú test_all_fakeclassª   s
            
 z#TestConsoleClass.test_all_fakeclassc                	   C   sf   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X d S )z* Checks if the method all works correclty r)   r*   r2   Ú allr    Nr,   r8   r
   r
   r 
   Ú test_all_working²   s
            
 z!TestConsoleClass.test_all_workingc                	   C   sf   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X d S )z? Checks that the all method works correctly with a class input r)   r*   r2   z
all BaseModelr    Nr,   r8   r
   r
   r 
   Ú test_all_trueclassº   s
            
 z#TestConsoleClass.test_all_trueclassc                	   C   s<   t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S ) z  Checks if the class is missing r)   r*   Ú updater4   NrA   r8   r
   r
   r 
   Ú test_update_missingclassÂ   s         
 z)TestConsoleClass.test_update_missingclassc                	   C   sb   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S )z  Checks if the class exists r)   r*   r2   z update FakeClassr7   NrA   r8   r
   r
   r 
   Ú test_update_wrongclassÈ   s
            
 z'TestConsoleClass.test_update_wrongclassc                	   C   sb   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S )z& Checks is the instance id is missing r)   r*   r2   z update BaseModelrD   NrA   r8   r
   r
   r 
   Ú test_update_noinstanceÐ   s
            
 z'TestConsoleClass.test_update_noinstancec                	   C   sb   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d ¡   |   |   ¡ d k ¡   W 5 Q R X d S )z  Checks is instance id exists r)   r*   r2   z update BaseModel 121212r<   NrA   r8   r
   r
   r 
   Ú test_update_notfoundØ   s
            
 z%TestConsoleClass.test_update_notfoundc                	   C   s€   t d t ƒ d  ,} t ƒ   d ¡   |   ¡ } |   t | ƒ d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X dS ) z) Checks if the attribute name is missing r)   r*   r2   r    ú update BaseModel z ** attribute name missing **
Nr=   ) r 
   Ú my_idr?   r9   r
   r
   r 
   Ú test_update_missing_nameà   s 
        
         z)TestConsoleClass.test_update_missing_namec                	   C   s„   t d t ƒ d  ,} t ƒ   d ¡   |   ¡ } |   t | ƒ d k ¡   W 5 Q R X t d t ƒ d  ,} t ƒ   d |   d   ¡   |   |   ¡ dk ¡   W 5 Q R X d S )	z* Checks if the attribute value is missing r)   r*   r2   r    rT   Z
first_namez ** value missing **
Nr=   ) r 
   rU   Zbase_idr9   r
   r
   r 
   Ú test_update_missing_valueê   s 
        
         z*TestConsoleClass.test_update_missing_valuec                	   C   s‚   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d  <} t ƒ   d |   d   ¡   t ƒ   d |   ¡   |   d|   ¡ k ¡   W 5 Q R X d S )	ú  update test working r)   r*   r2   rT   ú
 name bettyr;   Ú bettyN© r    r    r    r-   r.   r    © r 
   r9   Úuser_idr
   r
   r 
   Ú 
test_update_okô   s 
        
         z¬TestConsoleClass.test_update_okc                	   C   s‚   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d  <} t ƒ   d |   d   ¡   t ƒ   d |   ¡   |   d|   ¡ k ¡   W 5 Q R X d S )	rX   r)   r*   r2   rT   z 
 name betty hor;   rZ   Nr[   ) r 
   r9   Ú uidr
   r
   r 
   Ú test_update_okextraþ   s 
        
         z$TestConsoleClass.test_update_okextrac                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ú" Test the class user with console r)   r*   ú
create Userr7   z
show User r<   z all Userz 
update User rY   rZ   z
destroy User N©r    r    r    r-   r.   r    r    r\   r
   r
   r 
   Ú test_user_console    s$        
              
                 z"TestConsoleClass.test_user_consolec                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ra   r)   r*   z 
create Placer7   z
show Place r<   z	all Placez
update Place rY   rZ   z 
destroy Place Nrc   r\   r
   r
   r 
   Ú test_place_console    s$        
              
                 z#TestConsoleClass.test_place_consolec                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ra   r)   r*   z 
create Stater7   z
show State r<   z	all Statez
update State rY   rZ   z 
destroy State Nrc   r\   r
   r
   r 
   Ú test_state_console2   s$        
              
                 z#TestConsoleClass.test_state_consolec                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ra   r)   r*   z
create Cityr7   z
show City r<   z all Cityz 
update City rY   rZ   z
destroy City Nrc   r\   r
   r
   r 
   Ú test_city_consoleG   s$        
              
                 z"TestConsoleClass.test_city_consolec                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ra   r)   r*   z 
create Amenityr7   z
show Amenity r<   z
all Amenityz update Amenity rY   rZ   z destroy Amenity Nrc   r\   r
   r
   r 
   Ú test_amenity_console\   s$        
              
                 z%TestConsoleClass.test_amenity_consolec                	   C   sN   t d t ƒ d  (} t ƒ   d ¡   |   ¡ } |   | d k ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d |   ¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  $} t ƒ   d¡   |   |   ¡ d k ¡   W 5 Q R X t d t ƒ d  L} t ƒ   d |   d	  ¡   t ƒ   d |   ¡   |   d
|   ¡ k ¡   t ƒ   d
|   ¡   W 5 Q R X t d t ƒ d  &} t ƒ   d |   ¡   |   |   ¡ d ¡   W 5 Q R X d 
S )
ra   r)   r*   z
create Reviewr7   z 
show Review r<   z
all Reviewz 
update Review rY   rZ   z destroy Review Nrc   r\   r
   r
   r 
   Ú test_review_consoleq   s$        
              
                 z$TestConsoleClass.test_review_consolec                	   C   sf   t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X d S )z%test alternative all with [class].allr)   r*   rb   z
User.all()r    Nr,   r8   r
   r
   r 
   Ú test_alternative_all†   s
            
 z%TestConsoleClass.test_alternative_allc                	   C   sv   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d  0} t ƒ   d |   d   ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X dS ) ú'test alternative show with [class].showr)   r*   rb   ú
User.show("ú ")r    Nr=   r\   r
   r
   r 
   Ú test_alternative_showŽ   s 
        
       z&TestConsoleClass.test_alternative_showc                	   C   s¢   t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X t d t ƒ d   } t ƒ   d ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ d k ¡   W 5 Q R X dS ) rk   r)   r*   ú 
User.count()r    rb   é    N)r    r    r    r-   r    Ú intr.   r8   r
   r
   r 
   Ú
test_count—   s         
          
 z TestConsoleClass.test_countc                	   C   sœ   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d   } t ƒ   d |   d   ¡   W 5 Q R X t d t ƒ d  (} t ƒ   d ¡   |   t |   ¡ ƒ dk ¡   W 5 Q R X d S )	z1test alternative destroy with [class].destroy(id)r)   r*   rb   z 
User.destroy("rm   ro   r    N)r    r    r    r-   r.   r    rq   r\   r
   r
   r 
   Ú test_alternative_destroy¢   s         
          
 z)TestConsoleClass.test_alternative_destroyc                	   C   s¤   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d   } d } t ƒ   d |   |   ¡   W 5 Q R X t d t ƒ d  ,} t ƒ   d |   d  ¡   |   d |   ¡ k ¡   W 5 Q R X d	S )
ú)test alternative update with [class].showr)   r*   rb   z ", "name", "betty")ú
User.update("rl   rm   rZ   Nr[   © r 
   r9   r]   Ú liner
   r
   r 
   Ú test_alternative_update1­   s         
             z)TestConsoleClass.test_alternative_update1c                	   C   s¤   t d t ƒ d   } t ƒ   d ¡   |   ¡ } W 5 Q R X t d t ƒ d   } d } t ƒ   d |   |   ¡   W 5 Q R X t d t ƒ d  ,} t ƒ   d |   d  ¡   |   d |   ¡ k ¡   W 5 Q R X d	S )
rt   r)   r*   rb   z%", {'first_name': 'John', 'age': 89})ru   rl   rm   Z JohnNr[   rv   r
   r
   r 
   Ú test_alternative_update2¹   s         
             z)TestConsoleClass.test_alternative_update2)0Ú __name__Ú
__module__Ú 
__qualname__r    ÚmaxDiffr    r    r    r    r    r#   r(   r0   r3   r6   r:   r@   rB   rC   rE   rF   rG   rH   rI   rJ   rK   rM   rN   rP   rQ   rR   rS   rV   rW   r^   r`   rd   re   rf   rg   rh   ri   rj   rn   rr   rs   rx   ry   r
   r
   r
   r 
   r     
   sZ                    	  
         
               
               
 
 
 
               	 
 
  
r    Ú __main__) r    Z unittestr¬   Ú ior    Z unittest.mockr    Zconsoler    Z models.engine.file_storager    r    Ú TestCaser    rz   Ú mainr    r    r    r 
   Ú <module>    s           
  
  
  
       :  

